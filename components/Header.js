import { useNavigation } from '@react-navigation/native';
import React, { useEffect, useState, useCallback } from 'react';
import { Button, Text, TouchableOpacity, View } from 'react-native';
import { ClipPath, Defs, G, Path, Rect, Svg } from 'react-native-svg';

const Header = ({ tag, selectedDate, setShowCalendar, showCalendar }) => {
    const navigation = useNavigation()

    const parseDateString = (dateString) => {
        const date = new Date(dateString);
        const day = date.getDate();
        const monthIndex = date.getMonth();
        const year = date.getFullYear();
        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec',];

        const month = months[monthIndex];

        return `${day} ${month}, ${year}`;
    };

    return (
        <>
            <View className="h-[60px] flex flex-row justify-between items-center px-4 bg-white border-b-0.5 border-gray-200 w-full top-0 sticky">
                <TouchableOpacity onPress={() => navigation.navigate("Home", { tag: 'calendar' })} className="flex flex-row items-center">
                    <Svg width="30" height="30" viewBox="0 0 328 328" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <G clip-path="url(#clip0_1173_38378)">
                            <Path d="M105.926 68.224C104.905 69.2445 104.131 70.4745 103.484 71.8229L103.411 71.75L1.22082 301.951L1.32104 302.052C-0.574069 305.723 2.5966 313.194 9.09282 319.7C15.589 326.196 23.0601 329.367 26.7319 327.472L26.823 327.563L257.024 225.363L256.951 225.281C258.291 224.644 259.521 223.869 260.55 222.83C274.782 208.599 251.703 162.451 209.018 119.756C166.314 77.0618 120.166 53.9925 105.926 68.224Z" fill="#C8102E" />
                            <Path d="M118.444 109.333L3.79015 296.166L1.22082 301.951L1.32104 302.052C-0.57407 305.723 2.5966 313.194 9.09282 319.7C11.2066 321.814 13.4024 323.417 15.5526 324.775L154.889 154.889L118.444 109.333Z" fill="#D84258" />
                            <Path d="M209.665 119.046C252.214 161.613 275.839 206.986 262.409 220.398C248.989 233.828 203.615 210.212 161.039 167.663C118.481 125.096 94.8651 79.704 108.286 66.2833C121.716 52.8627 167.089 76.4787 209.665 119.046Z" fill="#B10020" />
                            <Path d="M161.884 123.533C159.897 124.755 157.45 125.21 155 124.617C147.267 122.752 141.024 119.17 136.965 114.262C132.667 109.066 131.048 102.628 132.501 96.5776C135.052 85.9568 147.139 77.4706 165.305 81.8433C172.371 83.5389 175.868 81.6488 176.119 80.5605C176.387 79.4836 174.138 76.2066 167.073 74.502C159.34 72.6374 153.097 69.0548 149.029 64.1459C144.731 58.9501 143.103 52.5104 144.565 46.4617C147.134 35.8432 159.212 27.3558 177.359 31.7352C182.509 32.9715 185.404 32.253 186.66 31.7081C187.664 31.2593 188.105 30.7652 188.182 30.4536C188.432 29.3743 186.219 26.102 179.136 24.3951C174.245 23.2108 171.225 18.2997 172.419 13.4014C173.594 8.5098 178.495 5.49691 183.404 6.68352C201.553 11.0449 208.463 24.0939 205.902 34.7227C203.331 45.3593 191.256 53.8286 173.089 49.4649C167.94 48.2196 165.07 48.9506 163.806 49.4943C162.803 49.934 162.352 50.4361 162.276 50.7386C162.016 51.8258 164.248 55.0914 171.331 56.7983C189.479 61.1687 196.39 74.2087 193.829 84.8375C191.27 95.4572 179.192 103.945 161.036 99.5639C155.886 98.3277 152.999 99.0564 151.735 99.591C150.721 100.048 150.289 100.543 150.213 100.846C149.954 101.924 152.185 105.198 159.259 106.904C164.14 108.087 167.169 113.008 165.976 117.898C165.402 120.341 163.869 122.32 161.884 123.533Z" fill="#FFC121" />
                            <Path d="M279.356 208.253C297.332 203.178 309.732 211.196 312.684 221.719C315.636 232.233 309.24 245.544 291.273 250.601C284.258 252.569 282.153 255.922 282.435 256.988C282.745 258.063 286.308 259.831 293.305 257.854C311.272 252.797 323.672 260.815 326.624 271.329C329.594 281.852 323.18 295.145 305.204 300.211C298.198 302.179 296.084 305.541 296.394 306.607C296.694 307.673 300.248 309.441 307.254 307.473C312.083 306.115 317.13 308.93 318.488 313.768C319.836 318.616 317.021 323.645 312.174 325.012C294.216 330.068 281.807 322.069 278.836 311.536C275.884 301.022 282.29 287.729 300.275 282.663C307.29 280.686 309.395 277.342 309.085 276.267C308.794 275.201 305.24 273.424 298.243 275.392C280.258 280.458 267.867 272.459 264.906 261.917C261.944 251.403 268.35 238.11 286.326 233.035C293.323 231.076 295.428 227.705 295.136 226.648C294.826 225.573 291.282 223.805 284.276 225.773C279.429 227.14 274.408 224.316 273.042 219.478C271.684 214.649 274.509 209.619 279.356 208.253Z" fill="#1E9A52" />
                            <Path d="M209.565 183.68C206.886 183.68 204.244 182.505 202.44 180.263C199.296 176.327 199.943 170.596 203.861 167.453C205.847 165.859 253.225 128.649 320.182 138.225C325.166 138.935 328.629 143.546 327.918 148.529C327.207 153.504 322.633 157.003 317.604 156.256C258.446 147.855 215.678 181.348 215.259 181.685C213.564 183.033 211.56 183.68 209.565 183.68Z" fill="#FFC121" />
                            <Path d="M52.4255 145.778C51.5599 145.778 50.6761 145.65 49.8015 145.395C44.9817 143.946 42.2483 138.872 43.697 134.052C54.0199 99.6756 63.377 44.8176 51.8788 30.5131C50.5941 28.8913 48.6535 27.2969 44.2072 27.634C35.661 28.29 36.4719 46.3209 36.481 46.5031C36.8637 51.5233 33.0917 55.8967 28.0806 56.2702C22.9875 56.58 18.687 52.8809 18.3135 47.8607C17.375 35.2964 21.2837 11.0973 42.8406 9.46644C52.4619 8.73755 60.4523 12.0813 66.0921 19.0969C87.6946 45.9838 65.7641 123.929 61.1539 139.291C59.9694 143.236 56.3432 145.778 52.4255 145.778Z" fill="#1E9A52" />
                            <Path d="M232.333 100.222C239.881 100.222 246 94.1034 246 86.5556C246 79.0077 239.881 72.8889 232.333 72.8889C224.785 72.8889 218.667 79.0077 218.667 86.5556C218.667 94.1034 224.785 100.222 232.333 100.222Z" fill="#1E9A52" />
                            <Path d="M18.2222 182.222C28.2861 182.222 36.4444 174.064 36.4444 164C36.4444 153.936 28.2861 145.778 18.2222 145.778C8.15837 145.778 0 153.936 0 164C0 174.064 8.15837 182.222 18.2222 182.222Z" fill="#FFC121" />
                            <Path d="M296.111 191.333C303.659 191.333 309.778 185.215 309.778 177.667C309.778 170.119 303.659 164 296.111 164C288.563 164 282.444 170.119 282.444 177.667C282.444 185.215 288.563 191.333 296.111 191.333Z" fill="#1E9A52" />
                            <Path d="M214.111 300.667C221.659 300.667 227.778 294.548 227.778 287C227.778 279.452 221.659 273.333 214.111 273.333C206.563 273.333 200.444 279.452 200.444 287C200.444 294.548 206.563 300.667 214.111 300.667Z" fill="#1E9A52" />
                            <Path d="M255.111 54.6667C265.175 54.6667 273.333 46.5083 273.333 36.4445C273.333 26.3806 265.175 18.2222 255.111 18.2222C245.047 18.2222 236.889 26.3806 236.889 36.4445C236.889 46.5083 245.047 54.6667 255.111 54.6667Z" fill="#FFC121" />
                            <Path d="M296.111 91.1111C303.659 91.1111 309.778 84.9923 309.778 77.4444C309.778 69.8965 303.659 63.7778 296.111 63.7778C288.563 63.7778 282.444 69.8965 282.444 77.4444C282.444 84.9923 288.563 91.1111 296.111 91.1111Z" fill="#1E9A52" />
                            <Path d="M268.778 127.556C276.326 127.556 282.445 121.437 282.445 113.889C282.445 106.341 276.326 100.222 268.778 100.222C261.23 100.222 255.111 106.341 255.111 113.889C255.111 121.437 261.23 127.556 268.778 127.556Z" fill="#FFC121" />
                            <Path d="M68.3332 227.778C75.8811 227.778 81.9998 221.659 81.9998 214.111C81.9998 206.563 75.8811 200.444 68.3332 200.444C60.7853 200.444 54.6665 206.563 54.6665 214.111C54.6665 221.659 60.7853 227.778 68.3332 227.778Z" fill="#FFC121" />
                        </G>
                        <Defs>
                            <ClipPath id="clip0_1173_38378">
                                <Rect width="328" height="328" fill="white" />
                            </ClipPath>
                        </Defs>
                    </Svg>
                    <Text className="text-xl font-black ml-2 mt-0.5">FesaSpot</Text>
                </TouchableOpacity>

                {tag != "map" && <TouchableOpacity className="flex items-end justify-center w-10 h-10" onPress={() => navigation.navigate("Home", { tag: 'settings' })}>
                    <Svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <Path d="M13.0505 7H3.5C2.11929 7 1 5.88071 1 4.5C1 3.11929 2.11929 2 3.5 2H13.0505M6.94949 18H16.5C17.8807 18 19 16.8807 19 15.5C19 14.1193 17.8807 13 16.5 13H6.94949M1 15.5C1 17.433 2.567 19 4.5 19C6.433 19 8 17.433 8 15.5C8 13.567 6.433 12 4.5 12C2.567 12 1 13.567 1 15.5ZM19 4.5C19 6.433 17.433 8 15.5 8C13.567 8 12 6.433 12 4.5C12 2.567 13.567 1 15.5 1C17.433 1 19 2.567 19 4.5Z" stroke="#121926" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" />
                    </Svg>
                </TouchableOpacity>}

                {tag == "map" && <View>
                    <TouchableOpacity className="px-4 py-1 bg-gray-100 rounded-md" onPress={() => { setShowCalendar(!showCalendar) }}><Text className="text-xl">{parseDateString(selectedDate)}</Text></TouchableOpacity>
                </View>}
            </View >
        </>
    )
}

export default Header